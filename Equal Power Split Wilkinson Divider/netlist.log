; Top Design: "Project1_V3_lib:Testbench:schematic"
; Netlisted using Hierarchy Policy: "Standard"

Options ResourceUsage=yes UseNutmegFormat=no EnableOptim=no TopDesignName="Project1_V3_lib:Testbench:schematic" DcopOutputNodeVoltages=yes DcopOutputPinCurrents=yes DcopOutputAllSweepPoints=no DcopOutputDcopType=0
; Library Name: Project1_V3_lib
; Cell Name: Schematic_emCosim
; View Name: emModel
define Schematic_emCosim ( P1  P2  P3  R1_P1  R1_P2  ref=0 ) 
;parameters 
; MomCmpt model has node 0 as implicit reference. Ref node will be ignored and assumed to be grounded!
em_data_name="Project1_V3_lib:Schematic_emCosim:emModel"
MomCmpt:em_data  P1 P2 P3 R1_P1 R1_P2 \
    name=em_data_name \
    paramFile="" \
    modelFile="C:/Users/ferpl/Plata_EEE545_Project1_wrk/Project1_V3_lib/%Schematic_em%Cosim/em%Model/model.ndx" \
    ModelReuse=1 \
    ModelType="MOMMW" \
    ExtrapolationMode="linear" \
    EnforcePassivity=-1
end Schematic_emCosim

; Library Name: Project1_V3_lib
; Cell Name: Schematic
; View Name: layout
define Schematic_in_Schematic_emCosim ( P1  P2  P3 ) 
;parameters 
R_1005_ERJ2:R1 N__6 N__30 X0=100Ohm X1=0.12 X2=1.2 X3=10.01422488 X4=0.0890871 X5=2.61678 X6=2.13732
model MSub1 MSUB H=32 mil noopt{ 16 mil to 48 mil } Er=3.55 noopt{ 1.77 to 5.32 } Mur=1 noopt{ 0.5 to 1.5 } Cond=1.0E+50 noopt{ 5e+49 to 1.5e+50 } Hu=3.93701e+34 mil noopt{ 1.97e+34 mil to 5.91e+34 mil } T=1.4 mil noopt{ 0.7 mil to 2.1 mil } TanD=0.0027 noopt{ 0.00135 to 0.00405 } Rough=2 um noopt{ 1 um to 3 um } DielectricLossModel=1 FreqForEpsrTanD=1.0 GHz noopt{ 0.5 GHz to 1.5 GHz } LowFreqForTanD=1.0 kHz noopt{ 0.5 kHz to 1.5 kHz } HighFreqForTanD=1.0 THz noopt{ 0.5 THz to 1.5 THz } RoughnessModel=2 
Schematic_emCosim:__emcosimModel  P1 P2 P3 N__6 N__30
end Schematic_in_Schematic_emCosim

model MSub1 MSUB H=32 mil noopt{ 16 mil to 48 mil } Er=3.55 noopt{ 1.77 to 5.32 } Mur=1 noopt{ 0.5 to 1.5 } Cond=1.0E+50 noopt{ 5e+49 to 1.5e+50 } Hu=3.93701e+34 mil noopt{ 1.97e+34 mil to 5.91e+34 mil } T=1.4 mil noopt{ 0.7 mil to 2.1 mil } TanD=0.0027 noopt{ 0.00135 to 0.00405 } Rough=2 um noopt{ 1 um to 3 um } DielectricLossModel=1 FreqForEpsrTanD=1.0 GHz noopt{ 0.5 GHz to 1.5 GHz } LowFreqForTanD=1.0 kHz noopt{ 0.5 kHz to 1.5 kHz } HighFreqForTanD=1.0 THz noopt{ 0.5 THz to 1.5 THz } RoughnessModel=2 


;##### Panasonic_DK_web_LIB model files BEGIN ##### 
#ifndef Panasonic_DK_web_LIB
#define Panasonic_DK_web_LIB
#include "C:/Users/ferpl/Downloads/Panasonic_DK_web/Panasonic_DK_web/circuit/models/Panasonic_Model.ads"
#endif
;##### Panasonic_DK_web_LIB model files END ##### 

S_Param:SP1 CalcS=yes CalcY=no CalcZ=no GroupDelayAperture=1e-4 FreqConversion=no FreqConversionPort=1 StatusLevel=2 CalcNoise=no SortNoise=0 BandwidthForNoise=1.0 Hz DevOpPtLevel=0 SPSS_WSP=yes \
SweepVar="freq" SweepPlan="SP1_stim" OutputPlan="SP1_Output" 

SweepPlan: SP1_stim Start=5 GHz Stop=6.5 GHz Step=1.0 MHz 

OutputPlan:SP1_Output \
      Type="Output" \
      UseEquationNestLevel=yes \
      EquationNestLevel=2 \
      UseSavedEquationNestLevel=yes \
      SavedEquationNestLevel=2

#load "python","LinearCollapse"
Component Module="LinearCollapse" Type="ModelExtractor" NetworkRepresentation=2
Port:TermG1  N__3 0 Num=1 Z=50 Ohm Noise=yes 
Port:TermG2  N__5 0 Num=2 Z=100 Ohm Noise=yes 
Port:TermG3  N__4 0 Num=3 Z=100 Ohm Noise=yes 
Schematic_in_Schematic_emCosim:X1  N__3 N__5 N__4 
